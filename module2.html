<!DOCTYPE html>
<html>
<head>
    <title>Module 2 ‚Äì Words in Action</title>
    <link rel="stylesheet" href="style.css">
</head>

<body onload="loadModule2()">

<div class="container">

    <h1>Module 2: Words in Action</h1>
    <h3>Welcome, <span id="username"></span>!</h3>

    <p style="text-align:center;">Use the vocabulary words in real sentences and fun activities!</p>


    <!-- DRAG AND DROP SENTENCE BUILDER -->
    <h2>Activity 1: Sentence Builder</h2>
    <p>Drag the correct word to complete the sentence.</p>

    <div class="drag-container">
        <p class="sentence">
            The wizard was very <span class="dropzone" data-answer="brilliant">_____</span>.
        </p>
        <p class="sentence">
            We began our long <span class="dropzone" data-answer="journey">_____</span> at sunrise.
        </p>
        <p class="sentence">
            She spoke in a soft <span class="dropzone" data-answer="whisper">_____</span>.
        </p>
    </div>

    <div class="word-bank">
        <div class="draggable" draggable="true">brilliant</div>
        <div class="draggable" draggable="true">whisper</div>
        <div class="draggable" draggable="true">journey</div>
    </div>

    <button class="btn" onclick="checkDragDrop()">Check Answers</button>

    <p id="dragFeedback" class="feedback"></p>


    <!-- STORY FILL IN THE BLANK -->
    <h2>Activity 2: Story Time</h2>
    <p style="text-align:center;">Choose the correct word to complete the story.</p>

    <div class="story-box">
        <p>
            Mia and her friends began their <select id="q1">
                <option>Select</option>
                <option>journey</option>
                <option>rescue</option>
            </select>
            early in the morning.
        </p>

        <p>
            They had to <select id="q2">
                <option>Select</option>
                <option>whisper</option>
                <option>rescue</option>
            </select>
            a small puppy stuck near the river.
        </p>

        <p>
            Mia had a <select id="q3">
                <option>Select</option>
                <option>brilliant</option>
                <option>gather</option>
            </select>
            idea to save it safely.
        </p>
    </div>

    <button class="btn" onclick="checkStory()">Check Story</button>

    <p id="storyFeedback" class="feedback"></p>


    <!-- FINISH MODULE -->
    <button class="btn" onclick="finishModule2()">Finish Module</button>

</div>


<script>

// LOAD NAME
function loadModule2() {
    let student = localStorage.getItem("studentName");
    document.getElementById("username").textContent = student || "Learner";
}


// -------------------------------
// DRAG AND DROP
// -------------------------------

let draggables = document.querySelectorAll(".draggable");
let dropzones = document.querySelectorAll(".dropzone");

draggables.forEach(item => {
    item.addEventListener("dragstart", dragStart);
});

dropzones.forEach(zone => {
    zone.addEventListener("dragover", allowDrop);
    zone.addEventListener("drop", dropWord);
});

function dragStart(e) {
    e.dataTransfer.setData("text", e.target.textContent);
}

function allowDrop(e) {
    e.preventDefault();
}

function dropWord(e) {
    e.preventDefault();
    let word = e.dataTransfer.getData("text");
    e.target.textContent = word;
}

function checkDragDrop() {
    let correct = 0;

    dropzones.forEach(zone => {
        if (zone.textContent.trim() === zone.dataset.answer.trim()) {
            correct++;
        }
    });

    let fb = document.getElementById("dragFeedback");

    if (correct === 3) {
        fb.textContent = "üéâ Excellent! All answers correct!";
        fb.style.color = "green";
    } else {
        fb.textContent = "‚ùó Some answers are wrong. Try again!";
        fb.style.color = "red";
    }
}



// -------------------------------
// STORY CHECK
// -------------------------------

function checkStory() {
    let score = 0;

    if (document.getElementById("q1").value === "journey") score++;
    if (document.getElementById("q2").value === "rescue") score++;
    if (document.getElementById("q3").value === "brilliant") score++;

    let fb = document.getElementById("storyFeedback");

    if (score === 3) {
        fb.textContent = "üåü Great job! You completed the story!";
        fb.style.color = "green";
        awardBadge("actionMaster");
    } else {
        fb.textContent = "‚ùó Some answers are incorrect. Try again.";
        fb.style.color = "red";
    }
}


// -------------------------------
// FINISH MODULE
// -------------------------------

function finishModule2() {
    alert("Module 2 Complete!");
    localStorage.setItem("module2done", true);
    window.location.href = "index.html";
}


// -------------------------------
// BADGE SYSTEM
// -------------------------------

function awardBadge(badgeName) {
    let badges = JSON.parse(localStorage.getItem("badges") || "[]");

    if (!badges.includes(badgeName)) {
        badges.push(badgeName);
        localStorage.setItem("badges", JSON.stringify(badges));
    }
}

</script>

</body>
</html>
